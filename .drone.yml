kind: pipeline
name: default

steps:
- name: build image
  image: docker:dind
  privileged: true
  volumes:
  - name: dockersock
    path: /var/run/docker.sock
  environment:
    SLACK_KEY:
      from_secret: SLACK_KEY
  commands:
  - docker ps -a
  - docker build . --build-arg SLACK_KEY=$SLACK_KEY --tag bot --force-rm --no-cache

volumes:
- name: dockersock
  host:
    path: /var/run/docker.sock
